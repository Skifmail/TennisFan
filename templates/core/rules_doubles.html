<h2>Парные турниры</h2>

<p>Парные турниры — это разновидность форматов FAN и Круговой, в которой участвуют команды по 2 человека (2 на 2). Оба формата поддерживают как одиночные (1 на 1), так и парные (2 на 2) турниры.</p>

<hr>

<h3>1. Общие положения</h3>

<h4>1.1. Варианты турнира</h4>
<p>При создании турнира организатор выбирает:</p>
<ul>
    <li><strong>Одиночный</strong> — участники играют один на один.</li>
    <li><strong>Парный</strong> — участники играют командами по 2 человека.</li>
</ul>

<h4>1.2. Парный турнир — ключевые отличия</h4>
<ul>
    <li>Регистрируются <strong>команды</strong>, а не отдельные игроки.</li>
    <li>Организатор задаёт <strong>максимальное количество команд</strong> (например, 8, 16).</li>
    <li>В сетках, таблицах, матрицах и карточках турниров отображаются <strong>два имени</strong> (оба игрока команды).</li>
    <li>Очки начисляются <strong>обоим игрокам команды</strong> одинаково: если команда выиграла — обоим начисляются очки победы; если проиграла — обоим начисляются очки поражения (или не начисляются, в зависимости от формата).</li>
</ul>

<hr>

<h3>2. Регистрация на парный турнир</h3>

<h4>2.1. Условия для регистрации</h4>
<p>Перед регистрацией система проверяет для каждого игрока:</p>
<ul>
    <li><strong>Активная подписка</strong> — у пользователя должна быть действующая подписка (если турнир многодневный).</li>
    <li><strong>Лимит регистраций</strong> — количество зарегистрированных турниров в текущем периоде не должно превышать лимит по тарифу подписки.</li>
</ul>
<p>Если условия не выполнены, система уведомит об этом и не позволит завершить регистрацию.</p>

<h4>2.2. Варианты регистрации</h4>
<p>При нажатии «Зарегистрироваться» на парный турнир система предлагает:</p>

<h5>Вариант А: Зарегистрироваться самостоятельно</h5>
<p>Игрок создаёт «команду без пары». Его имя отображается в списке участников с пометкой «ожидает партнёра». Партнёр может присоединиться позже:</p>
<ul>
    <li>Со страницы турнира — нажав «Присоединиться» рядом с игроком без пары.</li>
    <li>Из личного кабинета — выбрав турнир и команду для присоединения.</li>
</ul>

<h5>Вариант Б: Присоединиться к игроку без пары</h5>
<p>Если в турнире уже есть зарегистрированные игроки без партнёра, система предлагает список таких игроков. Игрок может выбрать одного из них и присоединиться к нему в команду. При присоединении проверяются условия регистрации у обоих игроков.</p>

<h5>Вариант В: Указать партнёра сразу</h5>
<p>Игрок может сразу добавить партнёра в команду. Доступен поиск партнёра по:</p>
<ul>
    <li><strong>ID в системе</strong> — уникальный номер игрока (отображается в личном кабинете в карточке пользователя: «Ваш ID в системе»).</li>
    <li><strong>Имени</strong> — фамилия и/или имя.</li>
    <li><strong>Телефону</strong>.</li>
    <li><strong>Email</strong>.</li>
</ul>
<p>При добавлении выбранного игрока система проверяет его возможность регистрации (подписка, лимит). Если условия не соблюдены — пользователь получает уведомление, команда не регистрируется. Если всё в порядке — команда считается зарегистрированной.</p>

<h4>2.3. Один игрок — один турнир</h4>
<p>Один игрок может участвовать в парном турнире только в одной команде. Нельзя зарегистрироваться в нескольких командах одного турнира.</p>

<hr>

<h3>3. Формирование сетки</h3>

<h4>3.1. Участвуют только полные команды</h4>
<p>В формировании сетки участвуют только команды, у которых указаны оба игрока. Команды с одним игроком (ожидающие партнёра) не включаются в сетку.</p>

<h4>3.2. FAN — парный турнир</h4>
<ul>
    <li>Команды сортируются по суммарному рейтингу (или по рейтингу первого игрока).</li>
    <li>Пары первого круга формируются по тому же принципу, что и в одиночном FAN: 1-я команда vs последняя, 2-я vs предпоследняя и т.д.</li>
    <li>При нечётном числе команд используется «Свободный круг» (bye) — сильнейшая команда получает автоматический выход во второй круг.</li>
    <li>Подвал создаётся для проигравших команд первого круга.</li>
</ul>

<h4>3.3. Круговой — парный турнир</h4>
<ul>
    <li>Каждая команда играет с каждой ровно один раз.</li>
    <li>При нечётном числе команд один «игрок» в каждом туре — BYE (отдых).</li>
    <li>Метод вращения применяется к командам так же, как к одиночным участникам.</li>
</ul>

<hr>

<h3>4. Начисление очков</h3>

<h4>4.1. Принцип: оба игрока получают одинаково</h4>
<p>Очки начисляются <strong>обоим игрокам команды</strong>:</p>
<ul>
    <li><strong>Победа команды</strong> — обоим игрокам начисляются очки победы (в FAN — при вылете/финале; в круговом — 1 очко за победу).</li>
    <li><strong>Поражение команды</strong> — обоим игрокам начисляются очки поражения (в FAN — очки за вылет; в круговом — 0 очков).</li>
</ul>

<h4>4.2. FAN — очки при вылете</h4>
<p>Когда команда проигрывает матч, оба игрока получают очки за вылет в соответствующем раунде (10, 25, 45, 70 очков — по настройкам турнира). Финалист и победитель — оба игрока команды получают очки финалиста/победителя.</p>

<h4>4.3. Круговой — 1 очко за победу</h4>
<p>За каждую победу команды оба игрока получают по 1 очку. За поражение — 0 очков. Очки добавляются к общему рейтингу (<code>total_points</code>) каждого игрока.</p>

<hr>

<h3>5. Подтверждение результатов матчей</h3>

<p>Результат матча в парном турнире может предложить любой из четырёх игроков (участников матча). Подтвердить должен игрок из противоположной команды. После подтверждения:</p>
<ul>
    <li>Результат применяется к матчу.</li>
    <li>Очки начисляются обоим игрокам победившей и обоим игрокам проигравшей команды.</li>
    <li>В FAN — победитель продвигается, проигравшим начисляются очки за вылет; создаётся следующий матч, подвал (если R1), финализация (если финал).</li>
    <li>В круговом — обновляются таблица и матрица.</li>
</ul>
<p>Все четыре игрока получают уведомления о подтверждении результата.</p>

<hr>

<h3>6. Отображение на сайте</h3>

<h4>6.1. Где показываются два имени</h4>
<p>В парных турнирах везде, где в одиночном формате отображается одно имя, отображаются два:</p>
<ul>
    <li><strong>Карточки турниров</strong> — список команд (например, «Иванов Иван / Петров Пётр»).</li>
    <li><strong>Сетка матчей</strong> — в каждой ячейке матча отображаются обе команды (4 имени).</li>
    <li><strong>Таблица результатов</strong> — в столбце «Игрок»/«Команда» — оба имени.</li>
    <li><strong>Матрица результатов</strong> — строки и столбцы — команды (два имени).</li>
    <li><strong>Страница матча</strong> — команда 1 vs команда 2.</li>
    <li><strong>Мои матчи</strong> — команды в списке матчей.</li>
</ul>

<h4>6.2. Бейджи</h4>
<p>На карточках турниров отображаются бейджи:</p>
<ul>
    <li><strong>Одиночный</strong> — для турниров 1 на 1.</li>
    <li><strong>Парный</strong> — для турниров 2 на 2.</li>
</ul>
<p>Также отображается «Команд: X/Y» вместо «Мест: X/Y» для парных турниров.</p>

<hr>

<h3>7. ID в системе</h3>

<p>В личном кабинете в карточке пользователя отображается строка «Ваш ID в системе» с уникальным номером. Этот ID присваивается при создании записи в базе данных и используется для поиска партнёра при регистрации на парный турнир. Партнёр может найти вас по этому ID, если вы его сообщите.</p>

<hr>

<h3>8. Краткая сводка</h3>

<table class="rules-summary-table" style="width:100%; border-collapse: collapse;">
<thead>
<tr style="background: var(--color-bg-elevated);">
<th style="padding: 8px; border: 1px solid var(--color-border);">Аспект</th>
<th style="padding: 8px; border: 1px solid var(--color-border);">Одиночный</th>
<th style="padding: 8px; border: 1px solid var(--color-border);">Парный</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding: 8px; border: 1px solid var(--color-border);">Участник</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">1 игрок</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Команда из 2 игроков</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid var(--color-border);">Лимит</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">max_participants</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">max_teams</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid var(--color-border);">Регистрация</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Один клик</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Solo / с партнёром / присоединиться</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid var(--color-border);">Очки</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Одному игроку</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Обоим игрокам команды</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid var(--color-border);">Отображение</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Одно имя</td>
<td style="padding: 8px; border: 1px solid var(--color-border);">Два имени (Фамилия Имя / Фамилия Имя)</td>
</tr>
</tbody>
</table>
